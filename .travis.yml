services:
- docker

env:
  global:
  - secure: "ir73jdHOaZ16A3LeKHkNXr0sIIGXpecRMz5TmW3yeU5o5EzSLZj1n8e2fzogFPpdDmXR5PKR/9g1U2fjlpGFuQkZICjOraGOUC5NSe3oKo+tYu5f0gZ7qf8Qk8/Z1YavAiUsaBzh2ZsvIZQG79ePFyKNSlf17HG3QEHgBZSYVoZDY8106/Z9tsnngIxjdbBivmySq5meLDN7rHWLt3blNfOlIA6lYuB6n5/Tw74hhVx/8kViHiXtEteeVBCz7QT84toCC17CuKaqVfXP+gYdodUCJLOwk84TOiKvoH0QHmqBqeENFbF/N8+4Jsh9njau2uUnGKNxZ6eslb7EeUWHDqKmFDZyX5jZv2g9Dai42yrdODuLwCuHTU6fPsIh/rp5Zd++g761l+wvvkza+1iMMve5tEvFc6ucNdyeH0wG8aKQHIJy1Shtq0ZPUMTWwUYsX4Extht/t/7fJAqiiAM9A0nkdkvjM8OVySw9uru3yvcRFAm3mFwejocTtO8UNVt7Lqmplc1Y1NgTorcYAfyzpF57mqK+yq3baK3oR91u+Br1SfR9Xx9lULOuKQWOrQRhq9bM4W8+lVf9PZdY/geZrqEj6OimvuetwirhjG10eTW24lloeMESlclo9QQC2G0nfkMqp8r+FiugRHOZGHkGQfcl1W8huk9w6D+7PlC7gf0="
  - secure: "x1UlIzjMX0IQxlH8+yQ8NWrXqP6dDvQUsLdsNWCtVZIUhnEpwY7kW22YmFNTJ+Wt0veYuDiKS6L4V0rSstOD7Jil9WAXd7om6EW0keyZ0Aokxe/4cftfw3iRoBGLzTagtHI0XCMD5bz5Jmnk/qYX8+fUVRZ0VzRvYdTQhy8Xu5avTE4gHpKUlCfWsvwWf5IFmWrafgBhbIT/qZ0qLq33yxdY/UpOkzodg3OBkKMiBXhSwt3iNecjhTOhE5oAFdK68L2sys2Ld3z++Th5A7BSeop6G5dXbQj9CST9Rvqp4gbEsSzg7gp9IsVf2Jpee0/r2iyjDl2OQn3tCX4CQP30XsNIR2KlFXGlKWo37Svzt7/eRNGFnXIaHeboqM1KOwMVRdTAM+tnoO7ndJ/WlXfhiXWRNEMme6Z7ashEbXWT7oGotnoTBdzQmapkAAgTIaZFrc/OFF7voh5npqh1ZLAcQeeBwO7mSFL+ZIeOoGIuhd8rF6yJ/h4QDfngS/1ipeQ8hRfC77nELUM1pcEh2WyElQ1bsXiNlnJE2FWk7fsks2hiBBtK5MDQkDGkQ2r28aEfz6/WZxtcjKPWAuT3BkYiv+KQrE/wdYSXUKxujz7bZHVd8CaPuXTsXhS7KSVhnVlVBT6OycNezhCniZsmgY+sqmbEN/yw2iDtPaGZKZH23M8="
  - secure: "MQgZje6ZyMQgj6MOoLNgVFVmXTsRtcGHu6RiHx4f0/vSx6ZHsa37gNfTMkFpsRmAdg5VtRCCmZurIcMz8zrfLJF/WGej/5VJRjFwfR+TgLbl7htZg3C9g88Li86gBF78vcclAI9ye//OA+vP9eCafuOhZz6+hP6MZG8gFoL6tRFS7QlAJxRebZi/PrWbxNCTkgt0ilZmWkZ+pQs5bJdVmS0ZEgjpWfPUNNazlMMxYqC/n+R7mDi99rTTJsUyO8TVnku18URMSTBD3Ot0Ulo7BmlKsHHdaa4K/PYvFNbc5MsVAwUl4Iros9jDmpsp5nWPJ5xrS++6uGN+GfSZccJ91z3yeeVSBxS5PJAePjFLI+xsOOPSGhyTK2RiuMQnjupBkKpr2Arfc0SL+JG8lm/LCJn+vpEFzLy4x12VgQgTHgDgrdTphIlCfLdVap6XwCM9lZ0qy5Pz8MpXYK76+FNZ0oOhrC3ZI7USbi9lblzo3My+ZSrh79KnSDZ81tnLAlf1ULWMzKzRfGUGwEUq7kxKVeNqvIQaQg3aL9Y057aDpMPdYGuhzbCWHGnH6I3YJ2cieEwDmXLy5YSzn3AECFljF4EITF5ilQaYueDuiJcI/Un3grOUAO/ILDX7pItQkqUU0h+VMUi+pTsOvxRlvbeu+H0XDM0kW3fZ3Bjj0+LUGo4="
  #- secure: "EaQchVIv0HODwGigQpkxvmS4lmc1iTcda8qdbwR/mZPijID7If+aywxG2JoqoxJs3u5k5JRDQ9xl7dztQZaqGDwuSWY2vVSWISQ+S2oiP8ID9aK5MWRsQfj1RwSocYV9B0PN1/+qj+RuFXsrPEIScteF7l1noWFntCevrPxG63BYAp4Kg4vbnFU0Z7dezTDVtgZPSostnV0nallHQv3ZuHWUDF74omLdHYbwev2bbWwTr/3u2yP1vbYiBcwZ+PT3TlkhYJJwtxYP3uUVbgqVwPIdTtWn0eF+FnnUMNLJalWOnChmD9xhMc1ivLWG6WqofWWxWjJXHRZxkpP6iBuSZGEdJReWL5McDeCzVAHlE3l7yA3UcPcUjxyZYNoP20zPzKaqFO0v2lGvniTgTUKiqgasXiSy64PQBUjUAkdhgIy9pmX1EIGnOR2nen/omuySYkd/01053bxI44EBjmBZ2EtabPgv7R3Y3CKGlNnMfQ5IM7LhmVeNqbSmCJkibzDVvUcLQlgf6c29Zp2a+5dmngug0Dw77WqXuApXrky5ZyDCPah/+WdNHF0oUYDDdJ0+O3qz53NDTgT4sgTU9Ynl55UfsstE9NdhiyXIiqMGd2CNvp73cKZSBYsM34IcAntDfJOJOLEtyg412+2NFX2unrJ4PYU2JOrmIDXAmVG6xY8="
  #- secure: "3Jp0HokVac9gWYq5YFrssWj5/jVQkayXJDbT2eiK1uTno9ajept0kpZcr+eRpTzC59s/Dvtf9hL33whCpZWjRJmaz3iB7GuKtJ+oLYX4qCd7QIgR+Y5DrqsfKDkdbiN7vf/p79ISwXOdvnmPdLsAUEjZncT9Kz1BLtnwZcZXRi/ZciKKRK0UrGCSzwbZHNO0r9ykxGeZRJ1lEh4qkfqk975k+UzSJnlGzQ+Dxgs7HtIjwtDzp+md3m2bRU4D/yNT/cKf6BNWsMvkQGu0iEZCIKIHfvghu0BMlhv33xZYN2uH0P03HzycV8Eh+3Etb82pJ30ndq7HpOnKEW1xufpaK2qLq0ubak/FvlxNiJKgoExIJ9BROoh32CSAgNOu8WoT81jwn9A6X6N/ltCzOUwdV9Gg6iLof/SPLSzrCfgZGxLZlpt3l7it+agn5fpi+vPpdp/7dq9AaHg0aesvRdu16lJZBFkiPZ/ZSjxsB0RDwz9HAT3d9X0dGyk2MaVvFCsSHcr+3RhQG5+lkjaRvrQas/6ov6pd+fkjTtaHc78FDN1/D1ImMS9IKSC6a8GahpwrL94opgH1+bH33J1QZS7dtJoECdJkm59j3UvH9nt6jLeekh1yE/9fObCaWqDOSQtQ12Na6n0RLNQ3uoHuoTCA/HnCRLqzy7QxlkwDuuUtAuk="
  - secure: "1EFWqw1rYlKHhqMk2LG3rlzZOf+XnFNbjSauy1KHBCGMWH4nGa/oqSo6BPk/NpiA765dlh+j3Zw7zyCEQFQPrpvi/C1KrAp9J56I/hYUVkqFMoMAmpfKa6/pLhwRrF991EK1W9H/86FkdIlFwaMJnJIYGtNw1hdp2fTlhZH/wVzoGCMeOuby2pRguRSmpe/vY/9+coXlqCUSZZK+DvbC1kuBGIEDyX80lwJXatrIWa/tqvbDw0VQ0Thr5hsixZA4SWctu/X+Z6RdImn82vjFEtB7ei+OaLdob1ojNY4xAqnTgUm4lzAFIhXJNme7kukhY1+ILtFVJSukwtEtV24/sjL9Iima5dwYpllFjW2yXHS3D7GFg8/94zo4Q8W6Dw78lsD57QG50s6NKFB4rnMDQAtNsylZn/RqaSYzrFZjIU+hYG7KPrveB717F8w40oMEBBgQgFK0ZJPhD9xg6BJGOCmPU/Rau0jMd/SWMdoLGz91LzsiVhdUNCxSm5ZDV0DThJT7fseuaL3woakakJ2QMHhXl2nkLP0LN8BTKR2bvlHubv8JCG8gXhLrXoe/jiOL2xb2pvQuflh5+POD5XXSjCQ97urKoGUWRhUwzJ33S7/d0n9AQXOMR9DcQFLzCv3LFzmEwKW8ygMc7voN4LJOmrwjatKdB2u1mM2cFX/JROI="
  - secure: "fRgFr1Ln70u4LumihjWGPnyDJ6aV1eMEsMRui1/sAJtGXfAJgooTHyiAZ8bt45GikbsRmJlXSuFbOnf+5gubF9BQBvdHYfpoYXGPXKclFPzBwMlGaO8XC5XsMXgVhlLocDIWZYfT1NVAKteu7KkgJ8zCc2bl9tWWxDN4NFkuEXeTSBmy1+BtC49agcLCcOqYP7s3UPOqouMT8Ubh6UPTesqnyQjpW4aXRrKE8QP8hqdNkohq2cL+MS4pwNLBRRzpMSfR+blrxR5wRP/iJMCskKg0e1Nrx7ND7UKjtpBhZqCKxuSLTJyR0nedkejxE13ZZ+wBtyJO+4shmCTAgGPaW7VYSCgZYWQzIdC14pMM+1SeK6MRBgOdGM/caOQ/DyCeONB2vAaOjUEBGikapQkkzyfi/kb2Y+kY/u9wvKIYnR/0wD7FohBK6d9SPnbzsiGnOB2lu8oVLbjdzUU9cdKuh5Ft/hwUdkmmIzsHlZ5Rlan5FF8ycORFaXRTd/9r/vtWIiuVzTokjM418Dix7/ZcYbEIuj4ZRVNYRp9xwu3ifSLDPZHfCN2kJLVhBWwP1vWlHSe+tbFFfgXbL8Nc1Pib/1WYfK0osjLtgWOX9AIXox7YS1gX+FoZTBZ9jY1pcIlnKfJAsOo81Y26GkveC2LS97AF1fB5ifBFk7GbGNRp00M="

script:
- echo $DOCKER_PASSWORD | docker login --username $DOCKER_USERNAME --password-stdin
- docker build --tag todo-app:test --target test .
- docker run --env-file .env.test todo-app:test todo_app/tests
- docker run --env BOARDID --env KEY --env TOKEN todo-app:test todo_app/tests_e2e
- docker build --tag todo-app:production --target production .
- docker push $DOCKER_USERNAME/todo-app:production